<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrapi - Web Scraping & AI Enrichment</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="portrait-styles.css">
    <link rel="stylesheet" href="keyword-styles.css"></head>
<body>
    <div class="container">
        <!-- √âcran 1: Accueil -->
        <div id="screen-home" class="screen active">
            <div class="logo">
                <h1>üï∏Ô∏è <span data-i18n="app.name">Scrapi</span></h1>
                <p data-i18n="app.tagline">Extraction intelligente de donn√©es web</p>
            </div>
            <div class="content">
                <h2 data-i18n="screens.home.title">Bienvenue sur Scrapi</h2>
                <p data-i18n="screens.home.subtitle">Analysez et enrichissez les donn√©es de n'importe quel site web avec l'IA</p>
                <button class="btn-primary" onclick="goToScreen('screen-url')" data-i18n="screens.home.buttons.start">
                    D√©marrer le scraping
                </button>
            </div>
        </div>

        <!-- √âcran 2: Saisie URL -->
        <div id="screen-url" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-home')">‚Üê <span data-i18n="screens.url.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.url.title">Entrez l'URL du site</h2>
            </div>
            <div class="content">
                <input type="url" id="urlInput" placeholder="https://exemple.com" data-i18n-placeholder="screens.url.placeholder">
                <label class="checkbox">
                    <input type="checkbox" id="downloadImages" checked>
                    <span data-i18n="screens.url.options.downloadImages">T√©l√©charger les images</span>
                </label>
                <button class="btn-primary" onclick="analyzeWebsite()" data-i18n="screens.url.buttons.next">
                    Suivant
                </button>
            </div>
        </div>

        <!-- √âcran 3: Info & Arborescence -->
        <div id="screen-info" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-url')">‚Üê <span data-i18n="screens.analysis.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.analysis.title">Analyse du site</h2>
            </div>
            <div class="content">
                <!-- Jauge de progression pour l'analyse -->
                <div id="analyzeProgressContainer" class="progress-container" style="display: none;">
                    <canvas id="analyzeProgressCanvas" width="200" height="200"></canvas>
                    <div class="progress-text">
                        <span id="analyzeProgressPercent">0%</span>
                    </div>
                </div>
                <div id="analyzeStatus" class="analyze-status" style="display: none;">
                    <p id="analyzeMessage" data-i18n="screens.analysis.status.starting">Analyse en cours...</p>
                    <p id="analyzeDetails" class="analyze-details"></p>
                </div>
                
                <div id="siteInfo" class="info-box">
                    <p data-i18n="screens.analysis.status.checking">V√©rification du site...</p>
                </div>
                <div id="siteTree" class="tree-box"></div>
                <button class="btn-primary" onclick="startScraping()" data-i18n="screens.analysis.buttons.download">
                    T√©l√©charger les pages
                </button>
                <button class="btn-secondary" onclick="searchFiches()" data-i18n="screens.analysis.buttons.searchCards">
                    Rechercher des fiches
                </button>
            </div>
        </div>

        <!-- √âcran 4: Progression -->
        <div id="screen-progress" class="screen">
            <div class="header">
                <h2 data-i18n="screens.progress.title">T√©l√©chargement en cours</h2>
            </div>
            <div class="content">
                <div class="progress-container">
                    <canvas id="progressCanvas" width="200" height="200"></canvas>
                    <div class="progress-text">
                        <span id="progressPercent">0%</span>
                    </div>
                </div>
                <div id="logs" class="logs-container"></div>
            </div>
        </div>

        <!-- √âcran 5: R√©sultats -->
        <div id="screen-results" class="screen">
            <div class="header">
                <h2 data-i18n="screens.results.title">R√©sultats</h2>
            </div>
            <div class="content">
                <div id="resultsInfo" class="info-box"></div>
                <button class="btn-primary" onclick="goToGoogleBusiness()" data-i18n="screens.results.buttons.continueGoogle">
                    Continuer avec Google Business
                </button>
                <button class="btn-secondary" onclick="goToScreen('screen-home')" data-i18n="screens.results.buttons.newScraping">
                    Nouveau scraping
                </button>
            </div>
        </div>

        <!-- √âcran 5b: Google Business -->
        <div id="screen-google-business" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-results')">‚Üê <span data-i18n="screens.google.buttons.back">Retour</span></button>
                <h2>üó∫Ô∏è Google Business</h2>
            </div>
            <div class="content">
                <div class="info-box">
                    <h3>Rechercher les fiches Google Business</h3>
                    <p>Nous allons rechercher toutes les fiches Google Business qui utilisent le m√™me site web.</p>
                    <div class="form-group">
                        <label>Localisation (optionnel)</label>
                        <input type="text" id="googleLocationInput" placeholder="Ex: Lausanne, Suisse">
                    </div>
                </div>
                <button class="btn-primary" onclick="searchGoogleBusinesses()">
                    üîç Rechercher les fiches
                </button>
                <div id="googleSearchStatus" class="status-message" style="display: none;"></div>
            </div>
        </div>

        <!-- √âcran 5c: R√©sultats Google Business -->
        <div id="screen-google-results" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-google-business')">‚Üê Retour</button>
                <h2>üìç Fiches trouv√©es</h2>
            </div>
            <div class="content">
                <div id="googleResultsList" class="google-results-list"></div>
                <div class="google-actions">
                    <button class="btn-secondary" onclick="selectAllGoogleBusinesses()">‚úì Tout s√©lectionner</button>
                    <button class="btn-primary" onclick="downloadGoogleBusinesses()">
                        üì• T√©l√©charger les fiches s√©lectionn√©es
                    </button>
                </div>
            </div>
        </div>

        <!-- √âcran 5d: T√©l√©chargement Google Business -->
        <div id="screen-google-download" class="screen">
            <div class="header">
                <h2>üì• T√©l√©chargement Google Business</h2>
            </div>
            <div class="content">
                <div class="progress-container">
                    <canvas id="googleProgressCanvas" width="200" height="200"></canvas>
                    <div class="progress-text">
                        <span id="googleProgressPercent">0%</span>
                    </div>
                </div>
                <div id="googleLogs" class="logs-container"></div>
            </div>
        </div>

        <!-- √âcran 5e: R√©sultats finaux Google Business -->
        <div id="screen-google-final" class="screen">
            <div class="header">
                <h2>‚úÖ T√©l√©chargement termin√©</h2>
            </div>
            <div class="content">
                <div id="googleFinalResults" class="info-box"></div>
                <button class="btn-primary" onclick="goToCatchmentAreaAnalysis()">
                    ‚û°Ô∏è Suivant
                </button>
                <button class="btn-secondary" onclick="downloadAllResults()">
                    üì¶ T√©l√©charger tout
                </button>
            </div>
        </div>

        <!-- √âcran Zone de chalandise -->
        <div id="screen-catchment-area" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-google-final')">‚Üê Retour</button>
                <h2>üìç Zone de chalandise</h2>
            </div>
            <div class="content">
                <div class="info-box">
                    <h3 id="catchmentLocationTitle">Analyse pour [Localit√©]</h3>
                    <p>D√©finissez le rayon de votre zone de chalandise</p>
                </div>
                
                <div class="catchment-controls">
                    <label for="radiusSlider">Rayon: <span id="radiusValue">10</span> km</label>
                    <input type="range" id="radiusSlider" min="1" max="100" value="10" oninput="updateRadius(this.value)">
                </div>
                
                <div class="catchment-stats">
                    <div class="stat-box">
                        <h4>Population totale dans la zone</h4>
                        <p id="totalPopulation" class="stat-value">0</p>
                    </div>
                    
                    <div class="stat-box">
                        <h4>Les 6 plus grandes communes</h4>
                        <div id="topCommunes" class="communes-list"></div>
                    </div>
                </div>
                
                <button class="btn-primary" onclick="nextCatchmentArea()">
                    Suivant
                </button>
            </div>
        </div>

        <!-- √âcran 6: Liste des fiches -->
        <div id="screen-fiches" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-info')">‚Üê <span data-i18n="screens.fiches.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.fiches.title">Fiches trouv√©es</h2>
            </div>
            <div class="content">
                <div id="fichesList" class="fiches-list"></div>
                <button class="btn-primary" onclick="extractFichesDetails()" data-i18n="screens.fiches.buttons.extract">
                    Extraire les d√©tails
                </button>
            </div>
        </div>

        <!-- √âcran 7: D√©tails des fiches -->
        <div id="screen-fiche-details" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-fiches')">‚Üê <span data-i18n="screens.ficheDetails.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.ficheDetails.title">D√©tails des fiches</h2>
            </div>
            <div class="content">
                <div id="fichesDetails" class="fiches-details"></div>
                <button class="btn-primary" onclick="enrichWithAI()" data-i18n="screens.ficheDetails.buttons.enrichWithAI">
                    Enrichir avec l'IA
                </button>
            </div>
        </div>

        <!-- √âcran 8: Enrichissement IA -->
        <div id="screen-enrichment" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-fiche-details')">‚Üê <span data-i18n="screens.enrichment.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.enrichment.title">Enrichissement IA</h2>
            </div>
            <div class="content">
                <div id="enrichmentResults" class="enrichment-results"></div>
                <button class="btn-primary" onclick="goToPlanAction()" data-i18n="screens.enrichment.buttons.createActionPlan">
                    Cr√©er un plan d'action
                </button>
            </div>
        </div>

        <!-- √âcran 9: Plan d'action -->
        <div id="screen-plan" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-enrichment')">‚Üê <span data-i18n="screens.actionPlan.buttons.back">Retour</span></button>
                <h2 data-i18n="screens.actionPlan.title">Plan d'action marketing</h2>
            </div>
            <div class="content">
                <div class="form-group">
                    <label data-i18n="screens.actionPlan.form.monthlyBudget">Budget mensuel (‚Ç¨)</label>
                    <input type="number" id="budgetInput" value="1000">
                </div>
                <div class="form-group">
                    <label data-i18n="screens.actionPlan.form.start">D√©but</label>
                    <input type="month" id="startMonthInput" value="2025-01">
                </div>
                <div class="form-group">
                    <label data-i18n="screens.actionPlan.form.end">Fin</label>
                    <input type="month" id="endMonthInput" value="2025-12">
                </div>
                <button class="btn-primary" onclick="generatePlan()" data-i18n="screens.actionPlan.buttons.generate">
                    G√©n√©rer le plan
                </button>
                <div id="planResults" class="plan-results"></div>
            </div>
        </div>

        <!-- √âcran Portrait Client -->
        <div id="screen-client-portrait" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-catchment-area')">‚Üê Retour</button>
                <h2>Portrait Client Intelligent</h2>
            </div>
            <div class="content">
                <div class="portrait-intro">
                    <h3>Analyse compl√®te avec Gemini AI</h3>
                    <p>L'intelligence artificielle va analyser toutes les donn√©es collect√©es pour cr√©er un portrait d√©taill√© de l'entreprise.</p>
                    
                    <div class="portrait-info">
                        <h4>Informations qui seront extraites :</h4>
                        <ul class="portrait-fields-list">
                            <li>Raison sociale et informations l√©gales</li>
                            <li>Ann√©e de fondation et historique</li>
                            <li>Nombre d'employ√©s et apprentis</li>
                            <li>Certifications et dipl√¥mes</li>
                            <li>üéØ Type de client√®le (B2B, B2C ou mixte)</li>
                            <li>üë• Segments de client√®le par type</li>
                            <li>üìë Services sp√©cifiques par cible</li>
                            <li>üí¨ Analyse critique des services</li>
                            <li>üìã Nombre d'avis et note par fiche Google</li>
                            <li>üó∫Ô∏è Zone(s) de chalandise et population</li>
                            <li>üèôÔ∏è Top 6 communes par zone</li>
                            <li>Services principaux (jusqu'√† 6)</li>
                            <li>Valeurs de l'entreprise</li>
                            <li>Textes de pr√©sentation g√©n√©r√©s</li>
                        </ul>
                    </div>
                    
                    <button id="startPortraitBtn" class="btn-primary" onclick="startPortraitAnalysis()">
                        ü§ñ D√©marrer l'analyse AI
                    </button>
                </div>
                
                <!-- Progression -->
                <div id="portraitProgressContainer" class="progress-container" style="display: none;">
                    <canvas id="portraitProgressCanvas" width="200" height="200"></canvas>
                    <div class="progress-text">
                        <span id="portraitProgressPercent">0%</span>
                    </div>
                    <p id="portraitStatus" class="status-message">Pr√©paration de l'analyse...</p>
                </div>
                
                <!-- R√©sultats -->
                <div id="portraitResults" class="portrait-results" style="display: none;">
                    <h3>Portrait Client Compl√©t√©</h3>
                    <div id="portraitContent" class="portrait-content">
                        <!-- Les r√©sultats seront affich√©s ici -->
                    </div>
                    
                    <div class="portrait-actions">
                        <button class="btn-secondary" onclick="downloadPortrait()">
                            üì• T√©l√©charger JSON
                        </button>
                        <button class="btn-primary" onclick="startKeywordResearch()">
                            ‚û°Ô∏è Suivant
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- √âcran Recherche de mots-cl√©s -->
        <div id="screen-keyword-research" class="screen">
            <div class="header">
                <button class="btn-back" onclick="goToScreen('screen-client-portrait')">‚Üê Retour</button>
                <h2>üîç Recherche de Mots-cl√©s Google Ads</h2>
            </div>
            <div class="content">
                <div id="keywordPreparation" class="info-box">
                    <p>Pr√©paration de la recherche de mots-cl√©s...</p>
                </div>
                
                <button id="launchKeywordBtn" class="btn-primary" onclick="launchKeywordResearch()" style="display: none;">
                    üöÄ Lancer la recherche
                </button>
                
                <!-- Progression -->
                <div id="keywordProgressContainer" class="progress-container" style="display: none;">
                    <canvas id="keywordProgressCanvas" width="200" height="200"></canvas>
                    <div class="progress-text">
                        <span id="keywordProgressPercent">0%</span>
                    </div>
                    <p id="keywordStatus" class="status-message">Recherche en cours...</p>
                </div>
                
                <!-- R√©sultats -->
                <div id="keywordResults" class="keyword-results" style="display: none;">
                    <!-- Les r√©sultats seront affich√©s ici -->
                </div>
                
                <div class="keyword-actions" style="display: none;">
                    <button class="btn-secondary" onclick="downloadKeywordResults()">
                        üì• T√©l√©charger CSV
                    </button>
                    <button class="btn-primary" onclick="goToNextFromKeywords()">
                        ‚û°Ô∏è Suivant
                    </button>
                </div>
            </div>
        </div>

        <!-- √âcran Optimisation IA des mots-cl√©s -->
        <div id="screen-ai-optimization" class="screen">
            <div class="header">
                <button class="btn-back" onclick="backToKeywordResults()">‚Üê Retour</button>
                <h2>ü§ñ Optimisation IA des Mots-cl√©s</h2>
            </div>
            <div class="content">
                <!-- Progression -->
                <div id="ai-optimization-progress" class="ai-progress-container">
                    <div class="progress-bar-container">
                        <div id="ai-progress-bar" class="progress-bar"></div>
                        <span id="ai-progress-text" class="progress-text">0%</span>
                    </div>
                    <p id="ai-progress-message" class="progress-message">Initialisation...</p>
                </div>
                
                <!-- R√©sultats -->
                <div id="ai-optimization-results" class="ai-results-container">
                    <!-- Les r√©sultats seront affich√©s ici -->
                </div>
                
                <!-- Actions -->
                <div id="ai-results-actions" class="ai-actions" style="display: none;">
                    <button class="btn-secondary" onclick="downloadAIResults()">
                        üì• T√©l√©charger l'analyse
                    </button>
                    <button class="btn-primary" onclick="backToKeywordResults()">
                        ‚Üí Retour aux r√©sultats
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="translations.js"></script>
    <script src="script.js"></script>
    <script src="google-business.js"></script>
    <script src="catchment-area.js"></script>
    <script src="client-portrait.js"></script>
    <script src="keyword-research.js"></script>
    <script src="ai-optimization.js"></script>
    <link rel="stylesheet" href="ai-optimization-styles.css">
</body>
</html>
